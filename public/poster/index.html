<!DOCTYPE html>
    <head>
        <!--WARNING: DO NOT TOUCH ANY OF THE SHITTY CODE YOU SEE HERE FOR YOUR BRAINS SAKE-->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-148429247-1"></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag(){dataLayer.push(arguments);}
			gtag('js', new Date());
			gtag('config', 'UA-148429247-1');
		</script>
        <meta charset="UTF-8">
        <title id="title">My Business Poster</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
            @page {
                margin: 0cm;
            }
            
            @media print {
                canvas{
                    display: none;
                }
                * {
                    -webkit-print-color-adjust: exact !important;   /* Chrome, Safari */
                    color-adjust: exact !important;                 /*Firefox*/
                }
            }
            #poster {
                height: 100%;
                font-family: "Century Gothic", sans-serif;
                color: #fff;
                background: linear-gradient(0deg, #000000, #000011, #000011);
                background-size: 400% 400%;
                margin: none;
            
                -webkit-animation: AnimationName 59s ease infinite;
                -moz-animation: AnimationName 59s ease infinite;
                animation: AnimationName 59s ease infinite;
            }

            @media only screen and (max-height: 1024px) {
                #poster {
                    zoom: 85%;
                }
            }

            @media only screen and (max-height: 900px) {
                #poster {
                    zoom: 65%;
                }
            }

            @media only screen and (max-height: 740px) {
                #poster {
                    zoom: 60%;
                }
            }

            @media only screen and (max-height: 680px) {
                #poster {
                    zoom: 55%;
                }
            }

            @media only screen and (max-height: 620px) {
                #poster {
                    zoom: 45%;
                }
            }
            
            @-webkit-keyframes AnimationName {
                0% {
                background-position: 0% 50%;
                }
                50% {
                background-position: 100% 50%;
                }
                100% {
                background-position: 0% 50%;
                }
            }
            @-moz-keyframes AnimationName {
                0% {
                background-position: 0% 50%;
                }
                50% {
                background-position: 100% 50%;
                }
                100% {
                background-position: 0% 50%;
                }
            }
            @keyframes AnimationName {
                0% {
                background-position: 0% 50%;
                }
                50% {
                background-position: 100% 50%;
                }
                100% {
                background-position: 0% 50%;
                }
            }
            
            .smart {
                margin-left: auto;
                margin-right: auto;
                margin-top: 1em;
            
                border-color: #ddd;
                background-color: #eee;
            
                width: 295px;
                height: 532px;
                border-radius: 50px;
                border: 5px solid #ddd;
                padding: 65px 10px;
            
                position: relative;
            }
            
            #acenzione-button {
                background-color: #ccc;
            
                height: 20px;
                left: -5px;
                top: 59px;
                border-radius: 4px 0 0 4px;
            
                width: 3px;
                background: #bbb;
                position: absolute;
            }
            
            #volume-su {
                height: 40px;
                width: 3px;
                left: -7px;
                top: 110px;
                border-radius: 4px 0 0 4px;
            
                width: 5px;
                background: #bbb;
                position: absolute;
            }
            
            #volume-giu {
                height: 40px;
                width: 3px;
                left: -7px;
                top: 155px;
                border-radius: 4px 0 0 4px;
            
                width: 5px;
                background: #bbb;
                position: absolute;
            }
            
            #dettaglio {
                position: absolute;
                left: 2;
                top: 17px;
                width: 100%;
            }
            
            #fotocamera {
                background: #aaa;
                height: 7px;
                width: 7px;
                margin: auto;
            
                border-radius: 100px;
                display: block;
            }
            
            #sensore {
                background: #aaa;
                height: 7px;
                width: 7px;
                margin: 12px 100px;
            
                border-radius: 100px;
                display: block;
            }
            
            #microfono {
                background: #aaa;
                height: 7px;
                width: 90px;
                margin: -19px auto 0;
                border-radius: 100px;
            }
            
            #schermo {
                height: 522px;
                width: 295px;
                background-color: #fff;
                box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1) inset;
                overflow: hidden;
                position: relative;
            }
            
            #bottone {
                height: 40px;
                width: 40px;
                background: #ddd;
                margin: 17px auto;
                border-radius: 100px;
                box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.15);
            }
            
            .frame-posizione {
                margin-left: 0px;
                margin-right: -1px;
                display: block;
            }
            
            #header {
                background: #555;
                box-shadow: 1px 2px 7px #333;
            }
            
            .wrap {
                width: 960px;
                max-width: 100%;
                margin: 0 auto;
            }
            
            #menu {
                position: relative;
                height: 60px;
            }
            
            #menu ul {
                list-style: none;
            }
            
            #menu ul li {
                float: left;
                padding: 3px;
            }
            
            #menu ul li a {
                display: block;
                padding: 20px;
                color: #fff;
                text-decoration: none;
                font-weight: 700;
            }
            
            #menu ul li a:hover {
                background: #444;
                transition-property: background-color;
                transition-duration: 0.4s;
                transition-timing-function: ease;
                color: #fff;
            }
            
            .three-lines-menu {
                position: absolute;
                bottom: 10px;
                right: 10px;
                text-decoration: none;
                color: #fff;
                font-size: 32px;
                display: none;
            }
            
            #menu ul {
                display: none;
                padding: 60px;
            }
            
            #menu ul li {
                float: none;
                background: #555;
            }
            
            .three-lines-menu {
                display: block;
                cursor: pointer;
            }
            
            #menu ul.menu-responsive {
                display: block;
                width: 100%;
                margin-top: 0;
            }

            p {
                margin: none;
                margin-top: 1em;
            }
        </style>
    </head>
    <body id="poster" crossorigin="use-credentials">
        <div style="text-align: center; color: #ccccdd;">
            <p style="font-size: 42px; margin-top: 80px;">Find us on Brinmo!</p>
            <p style="font-size: 28px; margin: none;" id="blink">brinmo.com/b/salti-delight-yola</p>
            <img height="80px" width="auto" style="margin: 20px; padding: none;" alt='Get it on Google Play' src='https://brinmo.com/images/playstore-badge.png' crossorigin = 'use-credentials' width="100%"/>
            <!--<img height="54px" width="auto" style="margin: 25px; padding: 13px;" alt='Coming Soon to AppStore' src='../images/cmsoon.jpg' width="100%"/>-->
        </div>
        <div class="smart" id="smart">
            <div id="dettaglio">
                <div id="sensore"></div>
                <div id="microfono"></div>
            </div>
            <div id="acenzione-button"></div>
            <div id="volume-su"></div>
            <div id="volume-giu"></div>
            <div id="schermo">
                <div id="bimagebg" crossorigin="use-credentials" style="height: 200px; display: flex; justify-content: center; background-position: 50%; background-size: cover;"></div>
                <div style="background-color: #000011; height: 90px; width: 100%;">
                    <div id="bname" style="padding-top: 20px; padding-left: 25px; font-size: 20px;">Salti delight</div>
                    <div style="padding-top: 10px; padding-left: 30px; padding-right: 30px; filter: grayscale(1);"> ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê <span style="float: right;">üë§99</span></div>
                </div>
                <div style="background-color: #000011; height: 80px; width: auto; display: block; text-align: center; padding-left: 40px; padding-right: 40px; padding-top: 30px;">
                    <span style="float: left; font-size: 30px; filter: grayscale(1);"><img height="45px" width="auto" src="https://brinmo.com/images/poster-call.png"/></span>
                    <span style="float: none; font-size: 30px; filter: grayscale(1);"><img height="45px" width="auto" src="https://brinmo.com/images/poster-shop.png"/></span>
                    <span style="float: right; font-size: 30px; filter: grayscale(1);"><img height="45px" width="auto" src="https://brinmo.com/images/poster-pay.png"/></span>
                </div>
                <div style="display: flex; margin: 20px;">
                    <div style="padding: 15px; height: 60px; width: 60px; background-color: #fff; font-size: 45px; border-radius: 50%; text-align: center; filter: grayscale(1);">
                        <img height="70px" width="70px" src="https://brinmo.com/images/profile.png"/>
                    </div>
                    <div style="color: #000011; height: 60px; margin-left: 10px; margin-top: 20px;">
                        <div style="padding-left: 5px; font-size: 14px;">@michael</div>
                        <div style="font-size: 16px;">Wow, they're good!</div>
                        <div style="text-align: right; font-size: 14px; color: #666677;">2 hours ago</div>
                    </div>
                </div>
            </div>
            <div id="bottone"></div>
        </div>
        <canvas style="width: 100%; height: 1%;"></canvas>
        <script src="poster/html2canvas.js" async></script>
        <script type="text/javascript" async>
                var searchValue = new URLSearchParams(window.location.search);
                var businessId = searchValue.get("b");
                var businessName = searchValue.get("n");
                var businessCity = searchValue.get("c");

                function picture(name) {
                    const screenshotTarget = document.body;

                    //DONT TOUCH! 
                    html2canvas(screenshotTarget, {
                        useCORS: true,
                        scale: 1,
                        x:0,
                        y:0,
                        width: screenshotTarget.clientWidth+400,
                        height: screenshotTarget.clientHeight,
                        windowWidth: screenshotTarget.clientWidth+400,
                        windowHeight: screenshotTarget.clientHeight,
                        backgroundColor: "#000011"
                    }).then((canvas) => {
                        const link = document.createElement('a');
                        link.download = name + '.png';
                        console.log(canvas);
                        canvas.toBlob(function(blob) {
                            console.log(blob)
                            link.href = URL.createObjectURL(blob);
                            link.click();
                        });
                    });
                }

                if(businessId && businessName && businessCity){
                    console.log(businessId + " " + businessName + " " + businessCity);
                    //get image through constructed link to business image
                    var imageLink = "https://firebasestorage.googleapis.com/v0/b/bizzybody-90f3e.appspot.com/o/business%2F"+businessId+"%2FprofileImage1_600x600.png?alt=media";
                    document.getElementById("bimagebg").style.backgroundImage = "url("+imageLink+")";
                    document.getElementById("bname").innerText = businessName;
                    document.getElementById("blink").innerText = "brinmo.com/b/" + businessName.replaceAll(" ", "-").toLowerCase() + "-" + businessCity.replaceAll(" ", "-").toLowerCase();
                    var picName = businessName.replaceAll(" ", "-").toLowerCase() + "-" + businessCity.replaceAll(" ", "-").toLowerCase();
                    setTimeout(function(){
                        if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){
                            alert("Screenshot and share!");
                            picture(picName);
                        } else {
                            alert("\nPlease make sure you set background graphics ON in your print settings. \n\nThis poster looks best in A4 with no margins.");
                            window.print();
                        } 
                    }, 3000);
                } else {
                    alert("Get a poster through your brinmo account settings");
                    window.location = "https://brinmo.com/business-settings";
                }
        </script>
    </body>
</html>